<!DOCTYPE html>
<html>
    <head>
        <title>More On Functions &mdash; PHP Introduction &mdash; A short introduction to PHP web development</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="https://xmartin.github.io/php-introduction//components/foundation/css/foundation.min.css" rel="stylesheet" type="text/css" />
        <link href="https://xmartin.github.io/php-introduction//components/highlightjs/styles/default.css" rel="stylesheet" type="text/css" />
        <link href="https://xmartin.github.io/php-introduction//css/style.css" rel="stylesheet" type="text/css" />
        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
            <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->

        <link rel="stylesheet" href="https://xmartin.github.io/php-introduction//components/highlightjs/styles/github.css" />
                                    </head>
    <body>
        <div class="off-canvas-wrap" data-offcanvas>
            <div class="inner-wrap">
                <nav class="tab-bar">
                                    <section class="left-small">
                    <a class="left-off-canvas-toggle menu-icon" href="#"><span></span></a>
                </section>
                <section class="middle tab-bar-section">
                    <h1 class="title">More On Functions &mdash; PHP Introduction</h1>
                </section>
                </nav>
                            <aside class="left-off-canvas-menu">
                <ul class="off-canvas-list">
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/intro/">Intro</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/installation/">Installing PHP</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/basic_syntax/">Basic Syntax</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/a_web_application/">A Web Application</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/objects_and_classes/">Objects and Classes</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/a_real_application/">A Real Application</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/builtin_functions_and_classes/">Built-in Functions and Classes</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/arrays/">Arrays</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/type_juggling/">Type Juggling and Comparisons</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/more_on_functions/">More On Functions</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/inheritance/">Inheritance</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/namespaces_and_autoloading/">Namespaces and Autoloading</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/all_of_it/">All Of It</a>
    </li>
    <li>
        <a href="https://xmartin.github.io/php-introduction/chapters/where_to_go_from_here/">Where To Go From Here</a>
    </li>
</ul>
            </aside>

            <section class="main-section">
                <div class="row">
                    <div class="small-12 columns">
                                                                                                                                            
<div class="row">
    <div class="small-4 columns text-left">
                    <a href="https://xmartin.github.io/php-introduction/chapters/type_juggling/">Previous</a>
            </div>
    <div class="small-4 columns text-center">
        <a href="https://xmartin.github.io/php-introduction/">Index</a>
    </div>
    <div class="small-4 columns text-right">
                    <a href="https://xmartin.github.io/php-introduction/chapters/inheritance/">Next</a>
            </div>
</div>
                        <hr>
                    </div>
                </div>
                <div class="row">
                    <div class="small-12 columns">
                        <p>We already covered the basics about functions in <a href="https://xmartin.github.io/php-introduction/chapters/basic_syntax/#function-definitions">basic syntax</a>.
Now we're going to get into more detail about them.</p>

<h2 id="type-hinting">Type hinting</h2>

<p>Among the popular dynamic languages, PHP has an unusual feature. It's called <a href="http://php.net/manual/en/language.oop5.typehinting.php">"type hinting"</a>.
In PHP, functions have a limited way of declaring the type of their expected arguments.
If an argument is supposed to be an <code>array</code> or an instance of a specific class, we can make sure that these requirements are fulfilled.</p>

<pre><code class="php">&lt;?php

function print_array(array $values)
{
    foreach($values as $value) {
        echo $value . PHP_EOL;
    }
}

class Foo
{
    protected $name;

    public function __construct($name) {
        $this-&gt;name = $name;
    }

    public function getName()
    {
        return $this-&gt;name;
    }
}

function print_foo(Foo $f)
{
    echo $f-&gt;getName();
}

$a = [1, 2, 3, 4];
$b = new Foo("some_name");

print_array($a);
/* prints:
1
2
3
4
*/

print_foo($b); //prints "some_name"

print_array("this is a string"); //terminates with a "Fatal Error"
</code></pre>

<p>Violations of type hints result in "Catchable fatal errors" and terminate the entire program, if they're not caught.
These errors can be caught like other exceptions. We will cover exception handling in a later chapter.</p>

<p>This ensures that a function can only be called with arguments of the correct type as long as the type is <code>array</code> or a class.
Because of this, it's often beneficial in PHP to wrap primitive values into objects so that they can be type hinted.</p>

<p>Type hints can prevent many of the <a href="https://xmartin.github.io/php-introduction/chapters/type_juggling">issues caused by PHP's type system</a> introduced in the previous chapter.</p>

<h2 id="default-values-for-arguments">Default values for arguments</h2>

<p>Sometimes a function doesn't need all of it's arguments for every call. It can be useful to provide default values for them.
That way, a function may be used more conveniently without having to specify all arguments.</p>

<pre><code class="php">&lt;?php

function print_array(array $values, $reverse = false)
{
    if ($reverse) {
        $print_values = array_reverse($values);
    } else {
        $print_values = $values;
    }

    foreach ($print_values as $value) {
        echo $value . PHP_EOL;
    }
}

print_array([1, 2, 3, 4]);
/* prints:
1
2
3
4
*/


print_array([1, 2, 3, 4], true);
/* prints:
4
3
2
1
*/
</code></pre>

<h2 id="pass-by-reference">Pass by reference</h2>

<p>Usually, function arguments are passed "by value". That means, the content of a variable is copied into the functions argument variable when it is called. As a consequence, function can't modify the contents of the variables where their arguments came from:</p>

<pre><code class="php">&lt;?php

$foo = 42;

function bar($n)
{
    $n = n + 1;
    return $n;
}
echo $foo . PHP_EOL;      // prints "42"
echo bar($foo) . PHP_EOL; // prints "43"
echo $foo . PHP_EOL;      // still prints "42"
</code></pre>

<p>The value <code>42</code> was copied into the function <code>bar()</code> and only that copy was modified into <code>43</code>. The value inside of <code>$foo</code> was not changed.</p>

<p>Sometimes, it is necessary to circumvent this. You can pass a variable into  a function "by reference". That means, you give the actual variable, not a copy of its value, into a function so the function can modify it. Arguments that are passed "by reference" are marked with an <code>&amp;</code>:</p>

<pre><code class="php">&lt;?php

$foo = 42;

function bar(&amp;$n)
{
    $n = n + 1;
    return $n;
}
echo $foo . PHP_EOL;      // prints "42"
echo bar($foo) . PHP_EOL; // prints "43"
echo $foo . PHP_EOL;      // also prints "43"
</code></pre>

<p>Now, the value in <code>$foo</code> has changed because it wasn't copied as it was passed into the function <code>bar()</code>.</p>

<p>Some of PHP's built-in functions have "by reference" arguments, for example <a href="http://php.net/manual/de/function.sort.php"><code>sort()</code></a>, <a href="http://php.net/manual/de/function.reset.php"><code>reset()</code></a> or <a href="http://php.net/manual/de/function.shuffle.php"><code>shuffle()</code></a>.</p>

<p>Usually it is not necessary to use "pass by reference" and it's often even dangerous as functions suddenly have side effects that can be hard to predict but there are situations where it is useful. One of them is described later in this chapter.</p>

<p><strong>Important note: Objects are ALWAYS passed by reference! They are not automatically copied when passed as arguments!</strong></p>

<h2 id="anonymous-functions">Anonymous functions</h2>

<p>When we built that small application with Silex, we already saw a slightly different function syntax:</p>

<pre><code class="php">&lt;?php

require "vendor/autoload.php";

$app = new Silex\Application();

$app-&gt;get("/", function(){
    return "Hello world!";
});

$app-&gt;run();
</code></pre>

<p>This piece of code contains a special kind of function called an <a href="http://php.net/manual/en/functions.anonymous.php">anonymous function</a>:</p>

<pre><code class="php">$app-&gt;get("/", function(){
    return "Hello world!";
});
</code></pre>

<p>Here, a function is created and used as an argument for the <code>$app-&gt;get()</code> function. Unlike "normal" PHP functions, it doesn't have a name. It's just a value that can be stored in a variable, passed into another function or be returned by a function. Functions that can be used like any other value are also called "higher order functions" or "first class functions".</p>

<p>A common usage for them is sorting. Let's sort an array of people's names by their last name, something the built in sorting functions can't do:</p>

<pre><code class="php">&lt;?php

$people = [
    "Marie Curie",
    "Alan Turing",
    "Grace Hopper",
    "Ada Lovelace",
    "Albert Einstein"
];

usort($people, function($a, $b) {
    $a_array = explode(' ', $a);
    $b_array = explode(' ', $b);
    $a_last_name = end($a_array);
    $b_last_name = end($b_array);

    return strcmp($a_last_name, $b_last_name);
});

var_dump($people);
/* prints:
array(5) {
  [0]=&gt;
  string(11) "Marie Curie"
  [1]=&gt;
  string(15) "Albert Einstein"
  [2]=&gt;
  string(12) "Grace Hopper"
  [3]=&gt;
  string(12) "Ada Lovelace"
  [4]=&gt;
  string(11) "Alan Turing"
}
*/
</code></pre>

<p>Here we use the <a href="http://php.net/manual/en/function.usort.php"><code>usort()</code></a> function that uses a custom function to compare values of an array in order to sort them. We then use an anonymous function that extracts the last names from the two arguments and passes them to <a href="http://php.net/manual/en/function.strcmp.php"><code>strcmp()</code></a>, returning the result.</p>

<p>Anonymous functions are a good way to inject behavior and logic into other functions or objects from the outside.</p>

<h2 id="closures">Closures</h2>

<p>PHP's anonymous functions have another feature. They can behave as closures. A closure is a function that has access to the scope in which is was originally defined while normal functions can only access their own arguments and variables that were created inside the function.</p>

<pre><code class="php"><br />$foo = 42;

$f = function($x) use ($foo) {
    return $x * $foo;
}

echo $f(2) . PHP_EOL; // prints: "84"
</code></pre>

<p>Unlike in other languages, we have to explicitly declare what variable the closure may access.</p>

<p>Let's say, we need a function that produces automatically increasing numbers. This can be implemented using a closure:</p>

<pre><code class="php">&lt;?php

function get_incrementor()
{
    $i = 0;

    return function() use (&amp;$i)
    {
        return $i++;
    };
}

$incrementor = get_incrementor();

echo $incrementor() . PHP_EOL;  // prints "0"
echo $incrementor() . PHP_EOL;  // prints "1"
echo $incrementor() . PHP_EOL;  // prints "2"
echo $incrementor() . PHP_EOL;  // prints "3"
echo $incrementor() . PHP_EOL;  // prints "4"

$incrementor2 = get_incrementor();
echo $incrementor2() . PHP_EOL; // prints "0"
echo $incrementor2() . PHP_EOL; // prints "1"

echo $incrementor() . PHP_EOL;  // prints "5"
</code></pre>

<p>Here we use a function that returns another function, one of the features of anonymous functions. But we also declare the variable <code>$i</code> and pass it into this anonymous function with the <code>use ()</code> syntax. We pass it "by reference" because it must be modified when the anonymous function is called.</p>

<p>Now this anonymous function is also a closure with access to <code>$i</code> and it can modify the variable <code>$i</code> because we passed it "by reference".</p>

<p>Every time the closure is called, it will return the value of <code>$i</code>and increment it by one. And by calling <code>get_incrementor()</code> again, we can get a new closure that starts at <code>0</code> again while the original one still continues its sequence as expected.</p>

<h2 id="argument-list-of-arbitrary-length">Argument list of arbitrary length</h2>

<p>Functions can be called with more arguments than they accept. Normally they just ignore those unknown arguments.</p>

<pre><code class="php">&lt;?php

function foo($a, $b)
{
    echo $a . ' ' . $b . PHP_EOL;
}

foo(1, 2, 3, 4); // prints "1 2"
</code></pre>

<p>But there are ways to access these excess arguments. One of them is the "variadic function" syntax that was introduced in PHP 5.6:</p>

<pre><code class="php">function bar($a, $b, ...$args) {
    echo $a . ' ' . $b . ' ' . implode('/', $args) . PHP_EOL;
}

bar(1, 2, 3, 4, 5); //prints "1 2 3/4/5"
</code></pre>

<p>This syntax is quite new and maybe not available on every PHP installation but there's another way to do this, using <a href="http://php.net/manual/en/function.func-get-args.php"><code>func_get_args()</code></a> and <a href="http://php.net/manual/en/function.func-get-arg.php"><code>func_get_arg()</code></a>:</p>

<pre><code class="php">function bar() {
    $a = func_get_arg(0);
    $b = func_get_arg(1);
    $args = array_slice(func_get_args(), 2);

    echo $a . ' ' . $b . ' ' . implode('/', $args) . PHP_EOL;
}

bar(1, 2, 3, 4, 5); //prints "1 2 3/4/5"
</code></pre>
                    </div>

                </div>
                <div class="row">
                    <div class="small-12 columns">
                        <hr>
                                                                                                                                            
<div class="row">
    <div class="small-4 columns text-left">
                    <a href="https://xmartin.github.io/php-introduction/chapters/type_juggling/">Previous</a>
            </div>
    <div class="small-4 columns text-center">
        <a href="https://xmartin.github.io/php-introduction/">Index</a>
    </div>
    <div class="small-4 columns text-right">
                    <a href="https://xmartin.github.io/php-introduction/chapters/inheritance/">Next</a>
            </div>
</div>
                    </div>
                </div>
            </section>

                <div class="row">
                    <div class="small-12 columns">
                        <footer class="main-footer">
                            <nav><ul class="inline-list">
                                    <li><a href="http://www.lnwdr.de">Author: Leon Weidauer</a></li>
                                    <li>
                                        <a href="https://www.github.com/berlinonline/php-introduction">PHP Introduction on Github</a>
                                    </li>
                                    <li>
                                        <a href="http://www.berlinonline.net">BerlinOnline Stadtportal GmbH & Co. KG</a>
                                    </li>
                            </ul></nav>
                        </footer>
                </div>
                <a class="exit-off-canvas"></a>
            </div>
        </div>

                <script src="https://xmartin.github.io/php-introduction//components/jquery/jquery.min.js"></script>
        <script src="https://xmartin.github.io/php-introduction//components/foundation/js/foundation.min.js"></script>
        <script>
            $(document).foundation();
        </script>
        <script src="https://xmartin.github.io/php-introduction//components/highlightjs/highlight.pack.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
            </body>
</html>

